YUI.add("moodle-atto_styles-button",function(c,e){c.namespace("M.atto_styles").Button=c.Base.create("button",c.M.editor_atto.EditorPlugin,[],{initializer:function(){var t,s,n,o,i,e=this.get("styles"),e=JSON.parse(e),a=[],l=["block","h3","h4","h5","blockquote"];c.Array.each(e,function(e){t="<i></i>",s="<span>",n='<span class="title">',o="","nostyle"===e.type?(t='<i class="fa fa-fw fa-times"></i>',s='<span class="nostyle">'):-1!=l.indexOf(e.type)?(t='<i class="fa fa-fw fa-tint"></i>',s='<span class="blockstyle">'):"inline"==e.type&&(t='<i class="fa fa-fw fa-i-cursor"></i>',s='<span class="inlinestyle">',o='<br /><span class="inlinehint tag tag-info">'+M.util.get_string("inlinehint","atto_styles")+"</span>"),!0===e.preview&&(n='<span class="preview '+e.classes+'">'),a.push({text:s+t+n+e.title+"</span>"+o+"</span>",callbackArgs:["<"+e.type+">",e.classes]})}),i=this._showToolbarMenu,this._showToolbarMenu=function(e,t){i.call(this,e,t),e=this.hasRangeSelected(),t=this.menus[t.buttonClass].get("contentBox"),e?t.removeClass("disableinline"):t.addClass("disableinline"),this.toolbar.after("click",c.bind(this._setDropdownHeight,this)),c.on("windowresize",c.bind(this._setDropdownHeight,this))},this.addToolbarMenu({icon:"icon",iconComponent:"atto_styles",buttonClass:"styles",globalItemConfig:{callback:this._changeStyle},items:a})},_changeStyle:function(e,t){var s,n,o,i,a,l,c=["<block>","<h3>","<h4>","<h5>","<blockquote>"];if("<nostyle>"!==t[0]){if(-1!=c.indexOf(t[0])){for(c="<block>"==t[0]?"<div>":t[0],document.execCommand("formatBlock",!1,c),n=window.getSelection().focusNode;n;n=n.parentNode)if(1===n.nodeType&&(o=window.getComputedStyle(n,null))&&"block"===o.getPropertyValue("display")){s=n;break}s.setAttribute("class",t[1])}else for(i=t[1].split(" "),a=this.get("host"),l=0;l<i.length;l+=1)a.toggleInlineSelectionClass([i[l]]);this.markUpdated()}else for(n=window.getSelection().focusNode;n;n=n.parentNode)if(1===n.nodeType&&(o=window.getComputedStyle(n,null))){n.removeAttribute("class");break}},hasRangeSelected:function(){var e=window.rangy.getSelection();return!!e.rangeCount&&!e.getRangeAt(0).collapsed},_setDropdownHeight:function(){var e=parseInt(this.editor._node.clientHeight,10)+35;c.one(".editor_atto_menu .atto_styles_button .dropdown-menu").setStyle("max-height",e)}},{ATTRS:{styles:{value:{}}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});